%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:55 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GGGAAGAGGAAGAAAGAGAGGCUCCAAGAGUAGUAGGACUGGGAACAUAUGAGAAAGCAUGAGCUCUAUCCAUCUAUCCAUCCCCUCCCAUUCGCUAGAAUGUUGCAGGUGGAGAUUUCGCUCUUAUGUUUUCUCGAUGCCUCACAUUCCUAUCGUUCUUGGAACUUCCUUCCUCUUCC\
) def
/coor [
[49.23587799 664.01513672]
[51.76247787 644.79882812]
[52.02426147 629.80114746]
[52.28604889 614.80340576]
[52.54783630 599.80572510]
[52.80961990 584.80798340]
[53.07140732 569.81030273]
[53.33319473 554.81256104]
[53.59497833 539.81481934]
[53.85676575 524.81713867]
[54.11855316 509.81942749]
[54.38033676 494.82168579]
[41.85202408 503.07040405]
[27.53707695 498.58908081]
[21.94878578 484.66891479]
[29.19134331 471.53326416]
[43.94561768 468.82931519]
[55.37595367 478.54354858]
[56.94388199 463.62570190]
[58.51180649 448.70788574]
[60.07973480 433.79003906]
[53.71518326 420.32373047]
[62.85260773 407.40792847]
[64.42053223 392.49011230]
[65.98846436 377.57226562]
[67.55638885 362.65444946]
[69.12431335 347.73660278]
[70.69224548 332.81878662]
[72.26016998 317.90097046]
[73.82809448 302.98312378]
[64.28422546 291.60549927]
[65.66181946 276.45437622]
[77.66041565 266.52102661]
[79.22834015 251.60321045]
[80.79627228 236.68537903]
[82.36419678 221.76754761]
[83.93212128 206.84971619]
[85.50005341 191.93188477]
[76.34562683 174.91848755]
[88.37252808 158.76368713]
[89.41887665 143.80023193]
[90.46522522 128.83677673]
[91.51156616 113.87331390]
[84.40668488 104.62284851]
[85.32183838 92.99473572]
[93.78633881 84.96961212]
[95.09367371 70.02668762]
[96.40100861 55.08376694]
[94.02686310 46.23357010]
[97.86379242 39.89223480]
[99.43171692 24.97440529]
[100.99964142 10.05657673]
[102.56757355 -4.86125135]
[104.13549805 -19.77907944]
[105.70342255 -34.69690704]
[107.27135468 -49.61473846]
[108.83927917 -64.53256226]
[110.40720367 -79.45039368]
[111.97513580 -94.36822510]
[113.54306030 -109.28604889]
[114.85039520 -124.22897339]
[115.89674377 -139.19242859]
[116.94309235 -154.15589905]
[117.98944092 -169.11935425]
[106.27365112 -179.12167358]
[102.73536682 -193.93161011]
[108.52765656 -207.82092285]
[121.23574829 -215.54377747]
[122.28209686 -230.50723267]
[123.32844543 -245.47070312]
[111.21611786 -236.62245178]
[96.37073517 -238.77062988]
[87.26346588 -250.68942261]
[89.09115601 -265.57766724]
[100.81088257 -274.93972778]
[115.73505402 -273.43334961]
[125.34783173 -261.91726685]
[127.95255280 -276.68939209]
[130.55726624 -291.46148682]
[133.16200256 -306.23361206]
[135.76672363 -321.00573730]
[138.37144470 -335.77786255]
[126.57841492 -343.59381104]
[118.68338013 -355.28176880]
[115.85315704 -369.05523682]
[118.48344421 -382.82415771]
[126.14390564 -394.51202393]
[137.64811707 -402.36895752]
[151.23727417 -405.23382568]
[154.09941101 -419.95825195]
[156.96153259 -434.68264771]
[159.82366943 -449.40707397]
[162.68580627 -464.13146973]
[156.83807373 -479.45257568]
[167.39120483 -492.00500488]
[183.48905945 -488.87588501]
[188.57153320 -473.28421021]
[177.41021729 -461.26934814]
[174.54808044 -446.54492188]
[171.68594360 -431.82052612]
[168.82380676 -417.09609985]
[165.96166992 -402.37170410]
[178.94378662 -393.07632446]
[186.60633850 -379.00210571]
[187.37359619 -362.93734741]
[181.04164124 -348.08996582]
[168.82923889 -337.44686890]
[153.14355469 -333.17312622]
[150.53883362 -318.40100098]
[147.93411255 -303.62890625]
[145.32939148 -288.85678101]
[142.72467041 -274.08465576]
[140.11994934 -259.31253052]
[138.29190063 -244.42434692]
[137.24555969 -229.46089172]
[136.19920349 -214.49743652]
[147.70881653 -205.08111572]
[151.51171875 -190.52082825]
[145.94673157 -176.34745789]
[132.95289612 -168.07301331]
[131.90655518 -153.10954285]
[130.86019897 -138.14608765]
[129.81385803 -123.18262482]
[132.23432922 -119.03601074]
[132.05621338 -113.32044983]
[128.46089172 -107.71812439]
[126.89295959 -92.80029297]
[125.32503510 -77.88246918]
[123.75711060 -62.96463776]
[122.18917847 -48.04681015]
[120.62125397 -33.12898254]
[119.05332947 -18.21115303]
[117.48539734 -3.29332447]
[115.91747284 11.62450409]
[114.34954834 26.54233170]
[112.78161621 41.46015930]
[111.34393311 56.39110565]
[110.03659821 71.33402252]
[108.72926331 86.27694702]
[116.21400452 101.27606964]
[106.47502899 114.91966248]
[105.42868042 129.88311768]
[104.38233948 144.84657288]
[103.33599091 159.81004333]
[110.95703888 167.62008667]
[112.96470642 178.12223816]
[108.93096161 187.78660583]
[100.41787720 193.49981689]
[98.84995270 208.41764832]
[97.28202820 223.33547974]
[95.71409607 238.25329590]
[94.14617157 253.17112732]
[92.57824707 268.08895874]
[102.24938965 280.29989624]
[100.44677734 295.40634155]
[88.74592590 304.55105591]
[87.17799377 319.46887207]
[85.61006927 334.38671875]
[84.04214478 349.30453491]
[82.47421265 364.22238159]
[80.90628815 379.14019775]
[79.33836365 394.05801392]
[77.77043915 408.97586060]
[84.02284241 423.50918579]
[74.99756622 435.35797119]
[73.42963409 450.27581787]
[71.86170959 465.19363403]
[70.29378510 480.11145020]
[69.37805176 495.08349609]
[69.11626434 510.08120728]
[68.85448456 525.07891846]
[68.59269714 540.07666016]
[68.33090973 555.07434082]
[68.06912231 570.07208252]
[67.80733490 585.06976318]
[67.54554749 600.06750488]
[67.28376770 615.06518555]
[67.02198029 630.06292725]
[66.76019287 645.06066895]
] def
/pairs [
[2 179]
[3 178]
[4 177]
[5 176]
[6 175]
[7 174]
[8 173]
[9 172]
[10 171]
[11 170]
[12 169]
[18 168]
[19 167]
[20 166]
[21 165]
[23 163]
[24 162]
[25 161]
[26 160]
[27 159]
[28 158]
[29 157]
[30 156]
[33 153]
[34 152]
[35 151]
[36 150]
[37 149]
[38 148]
[40 144]
[41 143]
[42 142]
[43 141]
[46 139]
[47 138]
[48 137]
[50 136]
[51 135]
[52 134]
[53 133]
[54 132]
[55 131]
[56 130]
[57 129]
[58 128]
[59 127]
[60 126]
[61 123]
[62 122]
[63 121]
[64 120]
[68 116]
[69 115]
[70 114]
[77 113]
[78 112]
[79 111]
[80 110]
[81 109]
[82 108]
[89 102]
[90 101]
[91 100]
[92 99]
[93 98]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
