%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:51 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGAGGAUGGCGAGGCGCGCGAGGUGGAGAAGCAGGGCACGUGCAUUCCUAGAGCUUCCGUCCAGCUCCCCGGCGGGCUAGCUAGCUCACUCCGCCGCCGCCGCCGCCGCCGCCGGCGCGCGCACGGCUGGCUGGCUCCGGCCGGCUGAGAUGCAUGCACGGAUGCAUGUGCCCUUCUUCUCCACCGUGCACGCCUCGCCUGCAGCAAGGA\
) def
/coor [
[134.25108337 846.74621582]
[133.35826111 831.77282715]
[122.08221436 822.10919189]
[120.96347046 806.93676758]
[131.17605591 795.17492676]
[119.89999390 785.51123047]
[118.78125000 770.33880615]
[128.99383545 758.57696533]
[128.10101318 743.60357666]
[127.20820618 728.63012695]
[126.31538391 713.65673828]
[125.42256927 698.68334961]
[124.52975464 683.70996094]
[123.63694000 668.73651123]
[122.74412537 653.76312256]
[121.85131073 638.78973389]
[113.37018585 626.54553223]
[120.27236938 612.30932617]
[119.37954712 597.33587646]
[118.48673248 582.36248779]
[110.00560760 570.11834717]
[116.90779114 555.88208008]
[116.01497650 540.90869141]
[115.12216187 525.93524170]
[114.22934723 510.96185303]
[113.33653259 495.98846436]
[112.44371033 481.01504517]
[111.55089569 466.04165649]
[110.65808105 451.06823730]
[109.76526642 436.09484863]
[108.87245178 421.12142944]
[100.39132690 408.87725830]
[107.29351044 394.64102173]
[106.40069580 379.66760254]
[105.50787354 364.69421387]
[104.61505890 349.72079468]
[103.72224426 334.74740601]
[102.82942963 319.77398682]
[101.93661499 304.80056763]
[101.04380035 289.82717896]
[100.15097809 274.85375977]
[99.25816345 259.88037109]
[98.36534882 244.90695190]
[97.47253418 229.93354797]
[96.57971954 214.96014404]
[95.68690491 199.98674011]
[94.79408264 185.01333618]
[85.56485748 180.51974487]
[78.98220062 172.53826904]
[76.28560638 162.46646118]
[78.02639771 152.10435486]
[83.95655823 143.33279419]
[93.06159973 137.77203369]
[92.83827209 122.77369690]
[80.85852814 114.26659393]
[76.12940216 100.35543823]
[80.44224548 86.30963898]
[92.16339111 77.44963074]
[91.94006348 62.45129395]
[91.71673584 47.45295334]
[91.49340820 32.45461655]
[91.15843201 17.45835876]
[90.71182251 2.46500826]
[90.26522064 -12.52834129]
[89.81861115 -27.52169228]
[89.37200928 -42.51504135]
[78.15081024 -53.31885910]
[77.91147614 -68.53060913]
[88.28041077 -79.16172791]
[87.83380890 -94.15507507]
[87.38719940 -109.14842987]
[86.94059753 -124.14177704]
[83.79647827 -129.95779419]
[84.02693176 -135.63616943]
[86.71061707 -139.58671570]
[86.71061707 -154.58671570]
[86.71061707 -169.58671570]
[86.71061707 -184.58671570]
[86.71061707 -199.58671570]
[86.71061707 -214.58671570]
[86.71061707 -229.58671570]
[86.71061707 -244.58671570]
[86.71061707 -259.58673096]
[86.71061707 -274.58673096]
[86.71061707 -289.58673096]
[86.71061707 -304.58673096]
[75.71696472 -310.53713989]
[68.33921814 -320.53900146]
[65.92809296 -332.65783691]
[68.88096619 -344.58181763]
[76.57789612 -354.06286621]
[87.51055145 -359.34039307]
[87.95716095 -374.33374023]
[88.40376282 -389.32708740]
[88.73873901 -404.32333374]
[88.96206665 -419.32168579]
[89.18539429 -434.32000732]
[89.40872192 -449.31835938]
[89.63204956 -464.31668091]
[89.74372101 -479.31628418]
[82.00641632 -493.11645508]
[89.74372101 -505.84371948]
[89.74372101 -520.84368896]
[81.08001709 -534.76751709]
[89.04414368 -549.10296631]
[105.44329071 -549.10296631]
[113.40742493 -534.76751709]
[104.74372101 -520.84368896]
[104.74372101 -505.84371948]
[112.48101807 -493.11645508]
[104.74372101 -479.31628418]
[107.88722229 -472.62747192]
[104.63038635 -464.09335327]
[104.40705872 -449.09503174]
[104.18373108 -434.09667969]
[103.96040344 -419.09835815]
[103.73707581 -404.10000610]
[106.78064728 -397.36514282]
[103.39711761 -388.88046265]
[102.95050812 -373.88711548]
[102.50390625 -358.89376831]
[116.96273041 -348.75405884]
[122.48907471 -331.81561279]
[116.69070435 -314.80215454]
[101.71061707 -304.58673096]
[101.71061707 -289.58673096]
[101.71061707 -274.58673096]
[101.71061707 -259.58673096]
[101.71061707 -244.58671570]
[101.71061707 -229.58671570]
[101.71061707 -214.58671570]
[101.71061707 -199.58671570]
[101.71061707 -184.58671570]
[101.71061707 -169.58671570]
[101.71061707 -154.58671570]
[101.71061707 -139.58671570]
[101.93394470 -124.58838654]
[102.38055420 -109.59503174]
[102.82715607 -94.60168457]
[103.27376556 -79.60832977]
[114.25709534 -69.61323547]
[114.92360687 -54.41420746]
[104.36535645 -42.96164703]
[104.81196594 -27.96829796]
[105.25856781 -12.97494793]
[105.70517731 2.01840234]
[106.15177917 17.01175308]
[109.49303436 23.60400391]
[106.49174500 32.23128891]
[106.71507263 47.22962570]
[106.93840027 62.22796631]
[107.16172791 77.22630310]
[119.14147186 85.73340607]
[123.87059784 99.64456177]
[119.55775452 113.69036102]
[107.83660889 122.55036926]
[108.05993652 137.54870605]
[123.19837952 150.75881958]
[123.73283386 170.53805542]
[109.76749420 184.12051392]
[110.66030884 199.09391785]
[111.55312347 214.06733704]
[112.44593811 229.04074097]
[113.33875275 244.01414490]
[114.23156738 258.98754883]
[115.12438965 273.96096802]
[116.01720428 288.93435669]
[116.91001892 303.90777588]
[117.80283356 318.88116455]
[118.69564819 333.85458374]
[119.58846283 348.82797241]
[120.48128510 363.80139160]
[121.37409973 378.77478027]
[122.26691437 393.74819946]
[130.81188965 407.06338501]
[123.84585571 420.22860718]
[124.73867035 435.20202637]
[125.63148499 450.17541504]
[126.52429962 465.14883423]
[127.41712189 480.12222290]
[128.30993652 495.09564209]
[129.20274353 510.06906128]
[130.09556580 525.04248047]
[130.98838806 540.01586914]
[131.88119507 554.98925781]
[140.42617798 568.30444336]
[133.46014404 581.46966553]
[134.35295105 596.44305420]
[135.24577332 611.41650391]
[143.79075623 624.73168945]
[136.82470703 637.89691162]
[137.71752930 652.87030029]
[138.61035156 667.84368896]
[139.50315857 682.81713867]
[140.39598083 697.79052734]
[141.28878784 712.76391602]
[142.18161011 727.73730469]
[143.07441711 742.71075439]
[143.96723938 757.68414307]
[155.50512695 768.14904785]
[156.19728088 783.34698486]
[146.14945984 794.28210449]
[157.68734741 804.74700928]
[158.37948608 819.94488525]
[148.33168030 830.88000488]
[149.22448730 845.85345459]
[160.22103882 857.53485107]
[157.80184937 873.39447021]
[143.82270813 881.26611328]
[129.00721741 875.11138916]
] def
/pairs [
[1 206]
[2 205]
[5 202]
[8 199]
[9 198]
[10 197]
[11 196]
[12 195]
[13 194]
[14 193]
[15 192]
[16 191]
[18 189]
[19 188]
[20 187]
[22 185]
[23 184]
[24 183]
[25 182]
[26 181]
[27 180]
[28 179]
[29 178]
[30 177]
[31 176]
[33 174]
[34 173]
[35 172]
[36 171]
[37 170]
[38 169]
[39 168]
[40 167]
[41 166]
[42 165]
[43 164]
[44 163]
[45 162]
[46 161]
[47 160]
[53 157]
[54 156]
[58 152]
[59 151]
[60 150]
[61 149]
[62 147]
[63 146]
[64 145]
[65 144]
[66 143]
[69 140]
[70 139]
[71 138]
[72 137]
[75 136]
[76 135]
[77 134]
[78 133]
[79 132]
[80 131]
[81 130]
[82 129]
[83 128]
[84 127]
[85 126]
[86 125]
[92 121]
[93 120]
[94 119]
[95 117]
[96 116]
[97 115]
[98 114]
[99 113]
[100 111]
[102 109]
[103 108]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
