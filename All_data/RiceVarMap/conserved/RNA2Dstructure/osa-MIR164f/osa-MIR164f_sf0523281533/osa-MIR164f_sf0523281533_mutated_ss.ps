%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:51 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGAGGAUGGCGAGGCGCGCGAGGUGGAGAAGCAGGGCACGUGCAUUCCUAGAGCUUCCGUCCAGCUCCCCGGCGGGCUAGCUAGCUCACUCCGCCGCCGCCGCCGCCGCCGCCGGCGCGCGCACGGCUGGCUGGCUCCGGCCGGCUGAGAUGCAUGCACGGAUGCAUGUGCCCUUCUUCUCCACCGUGCACGCCUCGCCUGCAGAAAGGA\
) def
/coor [
[102.92108917 919.21179199]
[94.60221100 906.59088135]
[90.37459564 892.07812500]
[90.61415863 876.96411133]
[95.29960632 862.59265137]
[104.01430511 850.24176025]
[115.98335266 841.00958252]
[130.14245605 835.71704102]
[129.24964905 820.74359131]
[128.35682678 805.77020264]
[127.46401215 790.79681396]
[126.57119751 775.82342529]
[125.67838287 760.84997559]
[124.78556824 745.87658691]
[123.89275360 730.90319824]
[122.99993896 715.92980957]
[114.51881409 703.68560791]
[121.42099762 689.44934082]
[120.52817535 674.47595215]
[119.63536072 659.50256348]
[111.15423584 647.25836182]
[118.05641937 633.02215576]
[117.16360474 618.04876709]
[116.27079010 603.07531738]
[115.37797546 588.10192871]
[114.48516083 573.12854004]
[113.59233856 558.15509033]
[112.69952393 543.18170166]
[111.80670929 528.20831299]
[110.91389465 513.23492432]
[110.02108002 498.26150513]
[101.53995514 486.01730347]
[108.44213867 471.78106689]
[107.54932404 456.80767822]
[106.65650177 441.83425903]
[105.76368713 426.86087036]
[104.87087250 411.88745117]
[103.97805786 396.91406250]
[103.08524323 381.94064331]
[102.19242859 366.96722412]
[101.29960632 351.99383545]
[100.40679169 337.02041626]
[99.51397705 322.04702759]
[98.62116241 307.07360840]
[97.72834778 292.10021973]
[96.83553314 277.12680054]
[95.94271088 262.15341187]
[86.71348572 257.65982056]
[80.13082886 249.67832947]
[77.43423462 239.60652161]
[79.17502594 229.24441528]
[85.10518646 220.47285461]
[94.21022797 214.91209412]
[93.98690033 199.91375732]
[81.72193146 191.50492859]
[76.70085144 177.31857300]
[81.04680634 162.72521973]
[93.29402161 153.38113403]
[93.07069397 138.38279724]
[92.84736633 123.38446045]
[92.62403870 108.38612366]
[92.28906250 93.38986206]
[91.84246063 78.39650726]
[91.39585114 63.40316010]
[90.94924164 48.40980911]
[90.50263977 33.41646194]
[79.28144073 22.61264229]
[79.04210663 7.40089226]
[89.41104889 -3.23022461]
[88.96443939 -18.22357559]
[88.51783752 -33.21692276]
[88.07122803 -48.21027374]
[84.92710876 -54.02629089]
[85.15756989 -59.70466232]
[87.84125519 -63.65521622]
[87.84125519 -78.65522003]
[87.84125519 -93.65522003]
[87.84125519 -108.65522003]
[87.84125519 -123.65522003]
[87.84125519 -138.65521240]
[87.84125519 -153.65521240]
[87.84125519 -168.65521240]
[87.84125519 -183.65521240]
[87.84125519 -198.65521240]
[87.84125519 -213.65521240]
[87.84125519 -228.65521240]
[76.84759521 -234.60562134]
[69.46984863 -244.60749817]
[67.05872345 -256.72631836]
[70.01159668 -268.65029907]
[77.70852661 -278.13134766]
[88.64118958 -283.40887451]
[89.08779144 -298.40222168]
[89.53440094 -313.39556885]
[89.86937714 -328.39184570]
[90.09270477 -343.39016724]
[90.31603241 -358.38851929]
[90.53936005 -373.38684082]
[90.76268768 -388.38519287]
[90.87435150 -403.38476562]
[83.13705444 -417.18493652]
[90.87435150 -429.91220093]
[90.87435150 -444.91220093]
[82.21064758 -458.83602905]
[90.17478180 -473.17144775]
[106.57392883 -473.17144775]
[114.53805542 -458.83602905]
[105.87435150 -444.91220093]
[105.87435150 -429.91220093]
[113.61164856 -417.18493652]
[105.87435150 -403.38476562]
[109.01785278 -396.69595337]
[105.76102448 -388.16186523]
[105.53769684 -373.16351318]
[105.31436920 -358.16519165]
[105.09104156 -343.16683960]
[104.86771393 -328.16851807]
[107.91127777 -321.43362427]
[104.52774811 -312.94897461]
[104.08113861 -297.95562744]
[103.63453674 -282.96228027]
[118.09336090 -272.82254028]
[123.61970520 -255.88412476]
[117.82133484 -238.87063599]
[102.84125519 -228.65521240]
[102.84125519 -213.65521240]
[102.84125519 -198.65521240]
[102.84125519 -183.65521240]
[102.84125519 -168.65521240]
[102.84125519 -153.65521240]
[102.84125519 -138.65521240]
[102.84125519 -123.65522003]
[102.84125519 -108.65522003]
[102.84125519 -93.65522003]
[102.84125519 -78.65522003]
[102.84125519 -63.65521622]
[103.06458282 -48.65687943]
[103.51118469 -33.66353226]
[103.95779419 -18.67018127]
[104.40439606 -3.67683053]
[115.38773346 6.31826735]
[116.05423737 21.51729393]
[105.49598694 32.96985626]
[105.94259644 47.96320343]
[106.38919830 62.95655441]
[106.83580780 77.94990540]
[107.28240967 92.94325256]
[110.65113068 100.26611328]
[107.62237549 108.16278839]
[107.84570312 123.16113281]
[108.06903076 138.15946960]
[108.29235840 153.15780640]
[120.81235504 162.13310242]
[125.59088135 176.59059143]
[120.99440765 190.92015076]
[108.98523712 199.69042969]
[109.20856476 214.68876648]
[124.34700775 227.89888000]
[124.88146210 247.67811584]
[110.91612244 261.26058960]
[111.80893707 276.23397827]
[112.70175171 291.20739746]
[113.59456635 306.18078613]
[114.48738098 321.15420532]
[115.38019562 336.12762451]
[116.27301788 351.10101318]
[117.16583252 366.07443237]
[118.05864716 381.04782104]
[118.95146179 396.02124023]
[119.84427643 410.99462891]
[120.73709106 425.96804810]
[121.62991333 440.94143677]
[122.52272797 455.91485596]
[123.41554260 470.88827515]
[131.96052551 484.20343018]
[124.99448395 497.36868286]
[125.88729858 512.34210205]
[126.78011322 527.31549072]
[127.67292786 542.28887939]
[128.56575012 557.26232910]
[129.45855713 572.23571777]
[130.35137939 587.20910645]
[131.24420166 602.18249512]
[132.13700867 617.15594482]
[133.02983093 632.12933350]
[141.57481384 645.44451904]
[134.60876465 658.60974121]
[135.50158691 673.58312988]
[136.39439392 688.55657959]
[144.93937683 701.87170410]
[137.97334290 715.03698730]
[138.86614990 730.01037598]
[139.75897217 744.98376465]
[140.65179443 759.95715332]
[141.54460144 774.93060303]
[142.43742371 789.90399170]
[143.33023071 804.87738037]
[144.22305298 819.85083008]
[145.11587524 834.82421875]
[159.80357361 838.39672852]
[172.78488159 846.14117432]
[182.90550232 857.36901855]
[189.26553345 871.08184814]
[191.29940796 886.06030273]
[188.82630920 900.97259521]
[182.06613159 914.49261475]
[171.61999512 925.41821289]
[158.41673279 932.77795410]
[143.63040161 935.91735840]
[128.57579041 934.55731201]
] def
/pairs [
[8 199]
[9 198]
[10 197]
[11 196]
[12 195]
[13 194]
[14 193]
[15 192]
[16 191]
[18 189]
[19 188]
[20 187]
[22 185]
[23 184]
[24 183]
[25 182]
[26 181]
[27 180]
[28 179]
[29 178]
[30 177]
[31 176]
[33 174]
[34 173]
[35 172]
[36 171]
[37 170]
[38 169]
[39 168]
[40 167]
[41 166]
[42 165]
[43 164]
[44 163]
[45 162]
[46 161]
[47 160]
[53 157]
[54 156]
[58 152]
[59 151]
[60 150]
[61 149]
[62 147]
[63 146]
[64 145]
[65 144]
[66 143]
[69 140]
[70 139]
[71 138]
[72 137]
[75 136]
[76 135]
[77 134]
[78 133]
[79 132]
[80 131]
[81 130]
[82 129]
[83 128]
[84 127]
[85 126]
[86 125]
[92 121]
[93 120]
[94 119]
[95 117]
[96 116]
[97 115]
[98 114]
[99 113]
[100 111]
[102 109]
[103 108]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
