%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:56 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AGCGAGUUAGGAAGAGGAAGAAAUUGAGUGUCUAAGAACAGUGGGAAUGGAAACAUUAAGGAAAGCCUACAGUAUUUUCUUCUCCACUAGAAUUAGGGGUGAAGAUAAUUCUUUUGUGUUUUCCUAAUGCUUCCCAUUCCUAUUGUUGUUAGAUACUCCUUCCUCUUCCUUUUGGCU\
) def
/coor [
[39.64397812 860.37652588]
[39.64397812 845.37652588]
[39.64397812 830.37652588]
[31.90667915 817.64929199]
[39.64397812 803.84912109]
[39.64397812 788.84912109]
[31.30586052 780.05938721]
[31.20095634 767.54315186]
[39.93218994 758.02276611]
[40.19691849 743.02514648]
[40.46164703 728.02746582]
[40.72637177 713.02978516]
[40.99110031 698.03210449]
[41.25582504 683.03448486]
[41.52055359 668.03680420]
[41.78528214 653.03912354]
[42.05000687 638.04150391]
[42.31473541 623.04382324]
[42.57946396 608.04614258]
[42.84418869 593.04846191]
[30.30739784 601.28430176]
[15.99650478 596.79003906]
[10.41904354 582.86553955]
[17.67017174 569.73461914]
[32.42586899 567.03845215]
[43.85188293 576.75634766]
[45.43736267 561.84039307]
[47.02284241 546.92437744]
[48.60832214 532.00842285]
[50.19379807 517.09246826]
[51.77927780 502.17648315]
[53.36475754 487.26049805]
[54.95023346 472.34454346]
[56.53571320 457.42855835]
[58.12119293 442.51257324]
[51.77248764 429.03878784]
[60.92510605 416.13372803]
[62.51058197 401.21777344]
[64.09606171 386.30178833]
[65.68154144 371.38583374]
[67.26702118 356.46984863]
[68.85250092 341.55386353]
[70.43797302 326.63790894]
[72.02345276 311.72192383]
[73.60893250 296.80596924]
[75.19441223 281.88998413]
[76.77989197 266.97399902]
[78.36537170 252.05802917]
[79.95085144 237.14205933]
[81.53632355 222.22608948]
[82.99011230 207.29670715]
[84.31210327 192.35507202]
[77.72660065 178.99542236]
[86.65003204 165.93084717]
[87.97202301 150.98922729]
[89.29400635 136.04759216]
[90.61599731 121.10595703]
[91.93798065 106.16432953]
[89.44934082 98.46996307]
[93.41742706 90.97145081]
[95.00290680 76.05548096]
[96.58838654 61.13950729]
[98.17386627 46.22353363]
[99.75934601 31.30756187]
[101.34482574 16.39158821]
[102.93030548 1.47561455]
[104.38409424 -13.45376873]
[92.85466003 -23.67034721]
[89.58997345 -38.54298019]
[95.63729858 -52.32317734]
[108.48558044 -59.81046677]
[109.80757141 -74.75209808]
[103.31661987 -89.18048096]
[112.14550018 -101.17631531]
[113.46748352 -116.11795044]
[114.78947449 -131.05958557]
[108.29852295 -145.48796082]
[117.12740326 -157.48379517]
[118.44939423 -172.42543030]
[119.77137756 -187.36706543]
[121.09336853 -202.30870056]
[122.41535187 -217.25032043]
[115.92440796 -231.67871094]
[124.75328064 -243.67454529]
[126.07527161 -258.61618042]
[119.58432007 -273.04455566]
[128.41320801 -285.04040527]
[129.73518372 -299.98202515]
[131.05717468 -314.92364502]
[123.65432739 -329.55682373]
[132.85087585 -343.13458252]
[149.18621826 -341.68930054]
[155.85594177 -326.70773315]
[145.99880981 -313.60168457]
[144.67681885 -298.66003418]
[143.35482788 -283.71841431]
[149.94033813 -270.35876465]
[141.01690674 -257.29418945]
[139.69491577 -242.35255432]
[146.28042603 -228.99290466]
[137.35697937 -215.92834473]
[136.03500366 -200.98670959]
[134.71301270 -186.04507446]
[133.39102173 -171.10343933]
[132.06903076 -156.16181946]
[138.65454102 -142.80215454]
[129.73110962 -129.73759460]
[128.40911865 -114.79595947]
[127.08712769 -99.85433197]
[133.67263794 -86.49467468]
[124.74919891 -73.43011475]
[123.42721558 -58.48847961]
[134.76129150 -48.86161041]
[138.29516602 -34.23369980]
[132.46986389 -20.16532135]
[119.32572174 -12.13178158]
[121.87594604 -5.17082977]
[117.84627533 3.06109309]
[116.26079559 17.97706604]
[114.67531586 32.89303970]
[113.08983612 47.80901337]
[111.50436401 62.72498703]
[109.91888428 77.64096069]
[108.33340454 92.55693054]
[106.87961578 107.48631287]
[105.55762482 122.42794800]
[104.23564148 137.36958313]
[102.91365051 152.31120300]
[101.59166718 167.25283813]
[108.08261108 181.68122864]
[99.25373840 193.67706299]
[97.93174744 208.61869812]
[100.29756165 217.47338867]
[96.45230103 223.81156921]
[94.86682129 238.72753906]
[93.28134155 253.64350891]
[91.69586182 268.55947876]
[90.11038208 283.47546387]
[88.52490997 298.39144897]
[86.93943024 313.30740356]
[85.35395050 328.22338867]
[83.76847076 343.13934326]
[82.18299103 358.05532837]
[80.59751129 372.97131348]
[79.01203156 387.88726807]
[77.42655945 402.80325317]
[75.84107971 417.71920776]
[82.07637787 432.25991821]
[73.03716278 444.09805298]
[71.45168304 459.01403809]
[69.86621094 473.93002319]
[68.28073120 488.84597778]
[66.69525146 503.76196289]
[65.10977173 518.67791748]
[63.52429199 533.59387207]
[61.93881607 548.50988770]
[60.35333633 563.42584229]
[58.76785660 578.34179688]
[57.84185410 593.31323242]
[57.57712555 608.31085205]
[57.31240082 623.30853271]
[57.04767227 638.30621338]
[56.78294373 653.30389404]
[56.51821899 668.30151367]
[56.25349045 683.29919434]
[55.98876190 698.29687500]
[55.72403717 713.29449463]
[55.45930862 728.29217529]
[55.19458008 743.28985596]
[54.92985535 758.28753662]
[64.22956085 774.16467285]
[54.64397812 788.84912109]
[54.64397812 803.84912109]
[62.38127899 817.64929199]
[54.64397812 830.37652588]
[54.64397812 845.37652588]
[54.64397812 860.37652588]
] def
/pairs [
[1 177]
[2 176]
[3 175]
[5 173]
[6 172]
[9 170]
[10 169]
[11 168]
[12 167]
[13 166]
[14 165]
[15 164]
[16 163]
[17 162]
[18 161]
[19 160]
[20 159]
[26 158]
[27 157]
[28 156]
[29 155]
[30 154]
[31 153]
[32 152]
[33 151]
[34 150]
[35 149]
[37 147]
[38 146]
[39 145]
[40 144]
[41 143]
[42 142]
[43 141]
[44 140]
[45 139]
[46 138]
[47 137]
[48 136]
[49 135]
[50 134]
[51 132]
[52 131]
[54 129]
[55 128]
[56 127]
[57 126]
[58 125]
[60 124]
[61 123]
[62 122]
[63 121]
[64 120]
[65 119]
[66 118]
[67 116]
[71 112]
[72 111]
[74 109]
[75 108]
[76 107]
[78 105]
[79 104]
[80 103]
[81 102]
[82 101]
[84 99]
[85 98]
[87 96]
[88 95]
[89 94]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
