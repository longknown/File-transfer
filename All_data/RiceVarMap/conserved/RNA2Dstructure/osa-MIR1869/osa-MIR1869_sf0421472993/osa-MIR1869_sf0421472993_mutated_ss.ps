%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:55 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AAGGAACACCUGAGAACAAUAGGCAUGGGAGGUAUUGGGAAAACACAGGAACAUAUUGUGACCCCUAAUUUUAAAGGGAAAUAAUGGUUGAAGCUUUCCUCCAUGUUCCCAUGCCUAAUGCUCUUAGGUGCUCUUUUU\
) def
/coor [
[113.84299469 572.00909424]
[113.16518402 557.02441406]
[112.48737335 542.03973389]
[111.80956268 527.05511475]
[111.13175201 512.07043457]
[102.82724762 499.70574951]
[109.93304443 485.57006836]
[109.25523376 470.58538818]
[108.57742310 455.60070801]
[107.89961243 440.61602783]
[107.22180176 425.63134766]
[106.54399109 410.64666748]
[105.86618042 395.66198730]
[105.18836975 380.67730713]
[104.51055908 365.69262695]
[96.20605469 353.32800293]
[103.31185913 339.19229126]
[102.63404846 324.20761108]
[94.32953644 311.84295654]
[101.43534088 297.70727539]
[100.75753021 282.72259521]
[100.07971954 267.73791504]
[99.40190887 252.75323486]
[98.72409821 237.76855469]
[98.04628754 222.78387451]
[97.36847687 207.79919434]
[96.69066620 192.81451416]
[96.01285553 177.82983398]
[95.33504486 162.84516907]
[94.65723419 147.86048889]
[93.97942352 132.87580872]
[80.32872009 127.02049255]
[70.56320190 115.82849121]
[66.61160278 101.51027679]
[69.25437927 86.89377594]
[77.96958160 74.86582947]
[91.03590393 67.80200195]
[90.35809326 52.81732559]
[89.68028259 37.83264923]
[89.00247192 22.84796906]
[88.32466125 7.86329174]
[87.64685059 -7.12138605]
[75.07196045 -11.46533489]
[64.76319122 -19.82442093]
[57.94768906 -31.17535210]
[55.42712021 -44.14041901]
[57.48338699 -57.15470886]
[63.84730911 -68.65497589]
[73.73361206 -77.26744080]
[85.93777466 -81.97184753]
[85.93777466 -96.97184753]
[85.93777466 -111.97184753]
[82.78717804 -120.63766479]
[86.11111450 -127.30988312]
[86.45011139 -142.30604553]
[86.78910065 -157.30221558]
[87.12808990 -172.29838562]
[87.46708679 -187.29455566]
[87.80607605 -202.29072571]
[77.40820312 -210.93125916]
[73.96199799 -223.80216980]
[78.51602936 -236.11625671]
[89.18570709 -243.42710876]
[89.86351776 -258.41177368]
[90.54132843 -273.39645386]
[91.21913910 -288.38113403]
[79.00698090 -297.95416260]
[74.78641510 -312.88623047]
[80.18033600 -327.43563843]
[93.11466217 -336.00784302]
[108.61588287 -335.30667114]
[120.72347260 -325.60174561]
[124.78180695 -310.62475586]
[119.23036957 -296.13473511]
[106.20381165 -287.70333862]
[105.52600098 -272.71865845]
[104.84819031 -257.73397827]
[104.17037964 -242.74929810]
[116.02396393 -230.87277222]
[115.65383911 -213.76040649]
[102.80224609 -201.95173645]
[102.46324921 -186.95556641]
[102.12425995 -171.95939636]
[101.78527069 -156.96322632]
[101.44627380 -141.96705627]
[101.10728455 -126.97089386]
[100.93777466 -111.97184753]
[100.93777466 -96.97184753]
[100.93777466 -81.97184753]
[116.31123352 -75.13733673]
[127.21829987 -62.25544357]
[131.45179749 -45.85897827]
[128.12289429 -29.19912529]
[117.84717560 -15.60083008]
[102.63152313 -7.79919672]
[103.30933380 7.18548107]
[103.98714447 22.17015839]
[104.66495514 37.15483856]
[105.34276581 52.13951492]
[106.02057648 67.12419128]
[119.67127991 72.97950745]
[129.43679810 84.17150879]
[133.38839722 98.48972321]
[130.74562073 113.10622406]
[122.03041840 125.13417053]
[108.96409607 132.19799805]
[109.64190674 147.18267822]
[110.31971741 162.16735840]
[110.99752808 177.15202332]
[111.67533875 192.13670349]
[112.35314941 207.12138367]
[113.03096008 222.10606384]
[113.70877075 237.09074402]
[114.38658905 252.07542419]
[115.06439972 267.06008911]
[115.74221039 282.04476929]
[116.42002106 297.02944946]
[124.77301025 310.46591187]
[117.61872101 323.52981567]
[118.29653168 338.51446533]
[126.64952087 351.95092773]
[119.49523926 365.01483154]
[120.17304993 379.99951172]
[120.85086060 394.98419189]
[121.52867126 409.96887207]
[122.20648193 424.95355225]
[122.88429260 439.93820190]
[123.56210327 454.92288208]
[124.23991394 469.90756226]
[124.91772461 484.89224243]
[133.27072144 498.32870483]
[126.11643219 511.39260864]
[126.79424286 526.37725830]
[127.47205353 541.36193848]
[128.14985657 556.34661865]
[128.82766724 571.33129883]
[135.58357239 586.88104248]
[122.51173401 597.67749023]
] def
/pairs [
[1 136]
[2 135]
[3 134]
[4 133]
[5 132]
[7 130]
[8 129]
[9 128]
[10 127]
[11 126]
[12 125]
[13 124]
[14 123]
[15 122]
[17 120]
[18 119]
[20 117]
[21 116]
[22 115]
[23 114]
[24 113]
[25 112]
[26 111]
[27 110]
[28 109]
[29 108]
[30 107]
[31 106]
[37 100]
[38 99]
[39 98]
[40 97]
[41 96]
[42 95]
[50 89]
[51 88]
[52 87]
[54 86]
[55 85]
[56 84]
[57 83]
[58 82]
[59 81]
[63 78]
[64 77]
[65 76]
[66 75]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
