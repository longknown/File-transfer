%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:52 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGUGAGAGGCUGAAGCUGCCAGCAUGAUCUGGUCCAUGAGUUGCACUGCUGAAUAUAUUGAAUUCAGCCAGGAGCUGCUACUGCAGUUCUGAUCUCGAUCUGCAUUCGUUGUUCUGAGCUAUGUAUGGAUUUGAUCGGUUUGAAGGCAUCCAUGUCUUUAAUUUCAUCGAUCAGAUCAUGUUGCAGCUUCACUCUCUCACU\
) def
/coor [
[81.38942719 700.52197266]
[87.43576813 684.68286133]
[87.43576813 669.68286133]
[87.43576813 654.68286133]
[87.43576813 639.68286133]
[87.43576813 624.68286133]
[87.43576813 609.68286133]
[87.43576813 594.68286133]
[87.43576813 579.68286133]
[79.69846344 566.95556641]
[87.43576813 553.15539551]
[87.43576813 538.15539551]
[87.43576813 523.15539551]
[87.43576813 508.15539551]
[87.43576813 493.15539551]
[87.43576813 478.15539551]
[87.43576813 463.15539551]
[87.43576813 448.15539551]
[87.43576813 433.15539551]
[84.28979492 426.46170044]
[87.55422211 417.92257690]
[87.78749847 402.92437744]
[88.02077484 387.92617798]
[88.25405121 372.92800903]
[88.48733521 357.92980957]
[88.72061157 342.93164062]
[88.95388794 327.93344116]
[89.18716431 312.93527222]
[89.42044067 297.93707275]
[89.65371704 282.93890381]
[89.88699341 267.94070435]
[90.12026978 252.94252014]
[90.35354614 237.94433594]
[90.58682251 222.94615173]
[83.04839325 210.10008240]
[90.99937439 196.42190552]
[91.23265076 181.42372131]
[91.46592712 166.42553711]
[91.69921112 151.42735291]
[91.93248749 136.42916870]
[81.25771332 134.39509583]
[71.14801025 129.17004395]
[62.56860352 120.93225861]
[56.42213440 110.15308380]
[53.45988464 97.57378387]
[54.20172501 84.15555573]
[39.66374207 80.46137238]
[25.12575531 76.76718903]
[10.55948353 73.18616486]
[-4.03419447 69.71852112]
[-18.62787247 66.25087738]
[-33.22154999 62.78322983]
[-47.81522751 59.31558609]
[-62.40890503 55.84793854]
[-74.84874725 65.32339478]
[-90.46640778 64.53421021]
[-101.88769531 53.85300064]
[-103.71983337 38.32311630]
[-95.09774017 25.27729225]
[-80.09250641 20.87536621]
[-65.78914642 27.19579315]
[-58.94126129 41.25426102]
[-44.34758377 44.72190475]
[-29.75390625 48.18955231]
[-15.16022778 51.65719604]
[-0.56654984 55.12483978]
[14.02712822 58.59248734]
[21.26676750 57.07915497]
[28.81993866 62.22920227]
[43.35792542 65.92338562]
[57.89590836 69.61756897]
[66.25369263 57.16174698]
[57.32405853 45.10929489]
[48.39442825 33.05683899]
[39.46479416 21.00438499]
[30.53516197 8.95193100]
[21.60552788 -3.10052299]
[12.67589474 -15.15297699]
[-2.57432699 -21.18313217]
[-4.70918512 -37.44272614]
[8.46747971 -47.20528412]
[23.40064430 -40.42792130]
[24.72834969 -24.08261108]
[33.65798187 -12.03015614]
[42.58761597 0.02229842]
[51.51725006 12.07475281]
[60.44688034 24.12720680]
[69.37651062 36.17966080]
[78.30614471 48.23211670]
[93.19019318 46.37063599]
[98.87651825 32.49022675]
[104.56285095 18.60982132]
[110.24917603 4.72941351]
[115.93550110 -9.15099335]
[111.68163300 -21.33252335]
[116.70903778 -32.77914047]
[127.82131195 -37.57014847]
[133.72280884 -51.36044312]
[139.62431335 -65.15074158]
[145.52581787 -78.94103241]
[151.42732239 -92.73133087]
[157.11364746 -106.61174011]
[162.58341980 -120.57889557]
[168.05319214 -134.54606628]
[173.52296448 -148.51321411]
[169.08016968 -160.62712097]
[173.92895508 -172.15054321]
[184.96537781 -177.11378479]
[190.65170288 -190.99418640]
[196.33802795 -204.87460327]
[190.00285339 -219.35359192]
[195.83911133 -234.04077148]
[210.38427734 -240.22251892]
[225.00894165 -234.23129272]
[231.03656006 -219.62159729]
[224.89105225 -205.06109619]
[210.21842957 -199.18827820]
[204.53210449 -185.30786133]
[198.84577942 -171.42745972]
[202.14042664 -154.19364929]
[187.49012756 -143.04344177]
[182.02035522 -129.07629395]
[176.55058289 -115.10912323]
[171.08081055 -101.14196777]
[172.14236450 -96.47879791]
[170.28070068 -91.09968567]
[165.21762085 -86.82982635]
[159.31611633 -73.03952789]
[153.41461182 -59.24923706]
[147.51310730 -45.45893860]
[141.61160278 -31.66864395]
[144.63783264 -14.38568401]
[129.81590271 -3.46466708]
[124.12957764 10.41574001]
[118.44325256 24.29614639]
[112.75692749 38.17655182]
[107.07060242 52.05696106]
[123.13475037 61.69988251]
[133.14112854 75.81333160]
[136.29930115 91.36692047]
[151.29203796 90.90042114]
[166.28479004 90.43392181]
[181.27752686 89.96743011]
[196.27027893 89.50093079]
[211.26301575 89.03443146]
[226.25576782 88.56793213]
[241.24850464 88.10143280]
[256.24124146 87.63494110]
[269.88888550 78.54239655]
[284.46505737 86.05684662]
[284.97506714 102.44805908]
[270.89425659 110.85416412]
[256.70776367 102.62767792]
[241.71501160 103.09417725]
[226.72225952 103.56067657]
[211.72952271 104.02717590]
[196.73677063 104.49367523]
[181.74403381 104.96017456]
[166.75128174 105.42666626]
[151.75854492 105.89316559]
[136.76579285 106.35966492]
[126.58777618 126.17745209]
[106.93067169 136.66244507]
[106.69739532 151.66062927]
[106.46411896 166.65881348]
[106.23084259 181.65699768]
[105.99755859 196.65518188]
[113.51931000 210.57402039]
[105.58501434 223.17942810]
[105.35173798 238.17761230]
[105.11846161 253.17579651]
[104.88517761 268.17398071]
[104.65190125 283.17218018]
[104.41862488 298.17034912]
[104.18534851 313.16854858]
[103.95207214 328.16671753]
[103.71879578 343.16491699]
[103.48551941 358.16308594]
[103.25224304 373.16128540]
[103.01896667 388.15945435]
[102.78568268 403.15765381]
[102.55240631 418.15585327]
[102.43576813 433.15539551]
[102.43576813 448.15539551]
[102.43576813 463.15539551]
[102.43576813 478.15539551]
[102.43576813 493.15539551]
[102.43576813 508.15539551]
[102.43576813 523.15539551]
[102.43576813 538.15539551]
[102.43576813 553.15539551]
[110.17306519 566.95556641]
[102.43576813 579.68286133]
[102.43576813 594.68286133]
[102.43576813 609.68286133]
[102.43576813 624.68286133]
[102.43576813 639.68286133]
[102.43576813 654.68286133]
[102.43576813 669.68286133]
[102.43576813 684.68286133]
[108.48210907 700.52197266]
] def
/pairs [
[2 200]
[3 199]
[4 198]
[5 197]
[6 196]
[7 195]
[8 194]
[9 193]
[11 191]
[12 190]
[13 189]
[14 188]
[15 187]
[16 186]
[17 185]
[18 184]
[19 183]
[21 182]
[22 181]
[23 180]
[24 179]
[25 178]
[26 177]
[27 176]
[28 175]
[29 174]
[30 173]
[31 172]
[32 171]
[33 170]
[34 169]
[36 167]
[37 166]
[38 165]
[39 164]
[40 163]
[46 71]
[47 70]
[48 69]
[49 67]
[50 66]
[51 65]
[52 64]
[53 63]
[54 62]
[72 89]
[73 88]
[74 87]
[75 86]
[76 85]
[77 84]
[78 83]
[90 137]
[91 136]
[92 135]
[93 134]
[94 133]
[97 131]
[98 130]
[99 129]
[100 128]
[101 127]
[102 124]
[103 123]
[104 122]
[105 121]
[108 119]
[109 118]
[110 117]
[140 161]
[141 160]
[142 159]
[143 158]
[144 157]
[145 156]
[146 155]
[147 154]
[148 153]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
