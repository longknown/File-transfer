%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:14:00 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AUCGUGAAGGCUAAAUGGAGAAGAGAGAGAGUACAGCUUUGGGCGGUUUAGUUGUUAGAUGGUGGAAGUACUUGCGACGCCUACUACCCUUUUCACCAAGGCUGUACCCUCCCUCUUCUUCUCUUAGCUUUUUAUGAU\
) def
/coor [
[103.74488068 725.03100586]
[103.74488068 710.03100586]
[103.74488068 695.03100586]
[103.74488068 680.03100586]
[103.74488068 665.03100586]
[103.74488068 650.03100586]
[103.74488068 635.03100586]
[103.74488068 620.03100586]
[103.74488068 605.03100586]
[103.57537079 590.03198242]
[103.23638153 575.03576660]
[102.89738464 560.03961182]
[102.55839539 545.04345703]
[102.21940613 530.04730225]
[91.30808258 519.97363281]
[90.75067139 504.77020264]
[101.39083862 493.39370728]
[101.05184937 478.39752197]
[100.71286011 463.40136719]
[100.37386322 448.40521240]
[100.03487396 433.40902710]
[99.69588470 418.41287231]
[99.35688782 403.41668701]
[99.01789856 388.42053223]
[98.67890930 373.42434692]
[90.65595245 360.87518311]
[98.07939911 346.90368652]
[97.74040985 331.90750122]
[97.40141296 316.91134644]
[89.37846375 304.36218262]
[96.80191040 290.39068604]
[96.46292114 275.39450073]
[96.12392426 260.39834595]
[95.78493500 245.40217590]
[95.44594574 230.40600586]
[95.10694885 215.40983582]
[94.76795959 200.41366577]
[94.42897034 185.41749573]
[94.08997345 170.42132568]
[93.75098419 155.42515564]
[93.41198730 140.42898560]
[93.07299805 125.43281555]
[76.71383667 112.35176849]
[75.05863190 91.47124481]
[89.15255737 75.97616577]
[87.12466431 61.11387634]
[85.09676361 46.25158691]
[73.48021698 32.01431274]
[80.64631653 16.03457069]
[78.28306580 1.22190738]
[75.91980743 -13.59075642]
[66.10491180 -25.99956131]
[71.74039459 -39.78689575]
[69.37713623 -54.59955978]
[67.01387787 -69.41222382]
[64.65061951 -84.22489166]
[60.17406082 -92.28610229]
[62.40527725 -99.39867401]
[50.10562134 -108.95671844]
[48.26076508 -124.05808258]
[57.44869995 -135.72502136]
[55.42080307 -150.58731079]
[53.39291000 -165.44960022]
[51.36501312 -180.31188965]
[40.89844894 -192.93658447]
[46.85140991 -208.21710205]
[63.09999847 -210.43415833]
[72.92906189 -197.30703735]
[66.22730255 -182.33978271]
[68.25519562 -167.47749329]
[70.28309631 -152.61520386]
[72.31098938 -137.75291443]
[84.28868103 -128.97393799]
[86.55697632 -113.93035126]
[77.26756287 -101.42657471]
[79.46327972 -86.58815002]
[81.82653809 -71.77548218]
[84.18979645 -56.96281815]
[86.55305481 -42.15015411]
[96.19891357 -30.80085182]
[90.73246765 -15.95401478]
[93.09572601 -1.14135039]
[95.45898438 13.67131329]
[105.09886169 21.06577492]
[107.14811707 33.44858932]
[99.95905304 44.22369003]
[101.98694611 59.08597946]
[104.01484680 73.94827271]
[112.34958649 76.71267700]
[119.31378174 82.06150818]
[124.13453674 89.40113831]
[126.27684784 97.91703033]
[125.50297546 106.66408539]
[121.89878845 114.67156219]
[115.86428070 121.05079651]
[108.06916809 125.09382629]
[108.40815735 140.08999634]
[108.74715424 155.08616638]
[109.08614349 170.08233643]
[109.42513275 185.07850647]
[109.76412964 200.07467651]
[110.10311890 215.07084656]
[110.44210815 230.06701660]
[110.78110504 245.06318665]
[111.12009430 260.05935669]
[111.45908356 275.05551147]
[111.79808044 290.05169678]
[119.84528351 303.67346191]
[112.39758301 316.57235718]
[112.73657990 331.56851196]
[113.07556915 346.56469727]
[121.12277222 360.18649292]
[113.67507172 373.08535767]
[114.01406860 388.08154297]
[114.35305786 403.07769775]
[114.69204712 418.07388306]
[115.03104401 433.07003784]
[115.37003326 448.06619263]
[115.70903015 463.06237793]
[116.04801941 478.05853271]
[116.38700867 493.05471802]
[127.53038025 503.93878174]
[127.66054535 519.15185547]
[117.21557617 529.70831299]
[117.55456543 544.70446777]
[117.89355469 559.70062256]
[118.23255157 574.69677734]
[118.57154083 589.69299316]
[121.91717529 598.28533936]
[118.74488068 605.03100586]
[118.74488068 620.03100586]
[118.74488068 635.03100586]
[118.74488068 650.03100586]
[118.74488068 665.03100586]
[118.74488068 680.03100586]
[118.74488068 695.03100586]
[118.74488068 710.03100586]
[118.74488068 725.03100586]
] def
/pairs [
[1 138]
[2 137]
[3 136]
[4 135]
[5 134]
[6 133]
[7 132]
[8 131]
[9 130]
[10 128]
[11 127]
[12 126]
[13 125]
[14 124]
[17 121]
[18 120]
[19 119]
[20 118]
[21 117]
[22 116]
[23 115]
[24 114]
[25 113]
[27 111]
[28 110]
[29 109]
[31 107]
[32 106]
[33 105]
[34 104]
[35 103]
[36 102]
[37 101]
[38 100]
[39 99]
[40 98]
[41 97]
[42 96]
[45 88]
[46 87]
[47 86]
[49 83]
[50 82]
[51 81]
[53 79]
[54 78]
[55 77]
[56 76]
[58 75]
[61 72]
[62 71]
[63 70]
[64 69]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
