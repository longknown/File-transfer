%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:57 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGUGUAAGAAGAGAGCUCUCUUCAGUCCACUCUCAGAUGGCUGUAGGGUUUUAUUAGCUGCCGAAUCAUCCAUUCACCUACCAAGAAAGUUGCAGGAGUGUAUCUCUUGGUAGCGGAUUGGAUGACGCGGGAGCUAAAAUUUAGCUCUGCGCCGUUUGUGGUUGGACUGAAGGGUGCUCCCUUGCUCAAGC\
) def
/coor [
[98.12502289 648.55926514]
[97.38900757 633.57733154]
[89.03652954 621.24505615]
[96.08737183 607.08184814]
[95.35135651 592.09991455]
[94.61534119 577.11798096]
[93.87932587 562.13604736]
[93.14331055 547.15411377]
[90.25698090 543.33074951]
[89.75257874 537.64978027]
[92.63645935 531.67156982]
[89.37828064 525.02435303]
[92.51174164 516.42663574]
[92.51174164 501.42663574]
[92.51174164 486.42663574]
[92.51174164 471.42663574]
[84.77443695 458.69937134]
[92.51174164 444.89920044]
[92.51174164 429.89920044]
[92.51174164 414.89920044]
[92.51174164 399.89920044]
[92.51174164 384.89920044]
[92.51174164 369.89920044]
[92.51174164 354.89920044]
[92.51174164 339.89920044]
[92.51174164 324.89920044]
[92.51174164 309.89920044]
[92.51174164 294.89920044]
[92.51174164 279.89920044]
[84.77443695 267.17190552]
[92.51174164 253.37174988]
[92.51174164 238.37174988]
[84.77443695 225.64447021]
[92.51174164 211.84429932]
[92.51174164 196.84429932]
[92.51174164 181.84429932]
[92.51174164 166.84429932]
[92.51174164 151.84429932]
[92.51174164 136.84429932]
[92.51174164 121.84429932]
[92.51174164 106.84429932]
[89.35832977 99.41094971]
[92.63645935 91.59937286]
[92.88188934 76.60137939]
[93.12731171 61.60338974]
[93.37274170 46.60540009]
[93.61816406 31.60740662]
[93.86359406 16.60941505]
[94.10901642 1.61142242]
[94.35444641 -13.38656998]
[79.54997253 -23.83180618]
[74.01570892 -40.91925812]
[79.78381348 -57.76328278]
[94.37131500 -67.69450378]
[94.12588501 -82.69249725]
[93.88046265 -97.69049072]
[93.63503265 -112.68847656]
[93.38961029 -127.68647003]
[93.14418030 -142.68446350]
[85.18212128 -156.35618591]
[92.71015167 -169.20835876]
[92.46472168 -184.20634460]
[92.21929932 -199.20434570]
[81.14404297 -210.15771484]
[81.10880280 -225.37130737]
[91.61943054 -235.86236572]
[91.37400055 -250.86036682]
[91.12857819 -265.85836792]
[90.88314819 -280.85635376]
[90.63772583 -295.85433960]
[90.39229584 -310.85232544]
[90.14687347 -325.85031128]
[82.18481445 -339.52206421]
[89.71283722 -352.37420654]
[89.46740723 -367.37222290]
[78.39215851 -378.32559204]
[78.35691071 -393.53918457]
[88.86753845 -404.03024292]
[88.62211609 -419.02822876]
[88.37668610 -434.02621460]
[88.13126373 -449.02423096]
[87.88583374 -464.02221680]
[87.64041138 -479.02020264]
[87.39498901 -494.01818848]
[87.14955902 -509.01617432]
[86.90413666 -524.01416016]
[76.90030670 -530.47302246]
[71.32023621 -540.85632324]
[71.45151520 -552.52337646]
[77.14553833 -562.56970215]
[86.88335419 -568.55047607]
[87.12878418 -583.54852295]
[87.37420654 -598.54650879]
[87.61963654 -613.54449463]
[79.18490601 -627.60815430]
[87.38252258 -641.81140137]
[103.77947998 -641.54309082]
[111.50798798 -627.07922363]
[102.61763000 -613.29907227]
[102.37220001 -598.30108643]
[102.12677765 -583.30310059]
[101.88134766 -568.30505371]
[115.37975311 -555.95666504]
[115.58536530 -537.34429932]
[101.90212250 -524.25958252]
[102.14755249 -509.26162720]
[102.39297485 -494.26361084]
[102.63840485 -479.26562500]
[102.88382721 -464.26763916]
[103.12925720 -449.26965332]
[103.37467957 -434.27163696]
[103.62010956 -419.27365112]
[103.86553192 -404.27566528]
[114.71379089 -394.13412476]
[115.17633820 -378.92752075]
[104.46540070 -367.61764526]
[104.71083069 -352.61962891]
[112.65533447 -340.02066040]
[105.14486694 -326.09576416]
[105.39028931 -311.09774780]
[105.63571167 -296.09976196]
[105.88114166 -281.10177612]
[106.12656403 -266.10379028]
[106.37199402 -251.10578918]
[106.61741638 -236.10780334]
[117.46567535 -225.96626282]
[117.92822266 -210.75965881]
[107.21728516 -199.44976807]
[107.46271515 -184.45178223]
[107.70813751 -169.45378113]
[115.65264893 -156.85481262]
[108.14217377 -142.92988586]
[108.38760376 -127.93190002]
[108.63302612 -112.93390656]
[108.87845612 -97.93591309]
[109.12387848 -82.93791962]
[109.36930847 -67.93992615]
[120.24530029 -62.50603867]
[127.81874084 -52.90295029]
[130.60073853 -40.91925812]
[128.00224304 -28.82054329]
[120.45739746 -18.92107391]
[109.35243988 -13.14114380]
[109.10700989 1.85684836]
[108.86158752 16.85484123]
[108.61615753 31.85283279]
[108.37073517 46.85082626]
[108.12530518 61.84881592]
[107.87988281 76.84680939]
[107.63445282 91.84480286]
[107.51174164 106.84429932]
[107.51174164 121.84429932]
[107.51174164 136.84429932]
[107.51174164 151.84429932]
[107.51174164 166.84429932]
[107.51174164 181.84429932]
[107.51174164 196.84429932]
[107.51174164 211.84429932]
[115.24903870 225.64447021]
[107.51174164 238.37174988]
[107.51174164 253.37174988]
[115.24903870 267.17190552]
[107.51174164 279.89920044]
[107.51174164 294.89920044]
[107.51174164 309.89920044]
[107.51174164 324.89920044]
[107.51174164 339.89920044]
[107.51174164 354.89920044]
[107.51174164 369.89920044]
[107.51174164 384.89920044]
[107.51174164 399.89920044]
[107.51174164 414.89920044]
[107.51174164 429.89920044]
[107.51174164 444.89920044]
[115.24903870 458.69937134]
[107.51174164 471.42663574]
[107.51174164 486.42663574]
[107.51174164 501.42663574]
[107.51174164 516.42663574]
[107.63445282 531.42614746]
[108.12524414 546.41809082]
[108.86125946 561.40002441]
[109.59727478 576.38195801]
[110.33329010 591.36389160]
[111.06930542 606.34582520]
[119.47442627 619.74969482]
[112.37094116 632.84130859]
[113.10695648 647.82324219]
[122.44343567 661.30517578]
[115.19230652 676.01409912]
[98.81291199 676.81878662]
] def
/pairs [
[1 188]
[2 187]
[4 185]
[5 184]
[6 183]
[7 182]
[8 181]
[11 180]
[13 179]
[14 178]
[15 177]
[16 176]
[18 174]
[19 173]
[20 172]
[21 171]
[22 170]
[23 169]
[24 168]
[25 167]
[26 166]
[27 165]
[28 164]
[29 163]
[31 161]
[32 160]
[34 158]
[35 157]
[36 156]
[37 155]
[38 154]
[39 153]
[40 152]
[41 151]
[43 150]
[44 149]
[45 148]
[46 147]
[47 146]
[48 145]
[49 144]
[50 143]
[54 137]
[55 136]
[56 135]
[57 134]
[58 133]
[59 132]
[61 130]
[62 129]
[63 128]
[66 125]
[67 124]
[68 123]
[69 122]
[70 121]
[71 120]
[72 119]
[74 117]
[75 116]
[78 113]
[79 112]
[80 111]
[81 110]
[82 109]
[83 108]
[84 107]
[85 106]
[86 105]
[91 102]
[92 101]
[93 100]
[94 99]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
