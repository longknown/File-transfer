%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:58 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UGCCAUGCCUUUCCACAGCUUUCUUGAACUUCUCUUGUGCCUCACUCACUUUCAUUACUGGAGAGAUAUGCAUCAUCAGUGGAAGCUUAUAGGGAGAGGAGUGCAAGAAGAGGGUCAAGAAAGCUGUGGGAAGAAAUGGCA\
) def
/coor [
[94.34845734 659.31054688]
[94.34845734 644.31054688]
[94.34845734 629.31054688]
[94.34845734 614.31054688]
[94.34845734 599.31054688]
[94.34845734 584.31054688]
[83.66758728 573.99285889]
[83.45390320 558.78070068]
[94.34845734 547.64758301]
[94.34845734 532.64758301]
[94.34845734 517.64758301]
[94.34845734 502.64758301]
[94.34845734 487.64758301]
[94.34845734 472.64758301]
[94.34845734 457.64758301]
[94.34845734 442.64758301]
[94.34845734 427.64758301]
[94.34845734 412.64758301]
[94.34845734 397.64758301]
[94.34845734 382.64758301]
[94.34845734 367.64758301]
[94.34845734 352.64758301]
[94.34845734 337.64758301]
[94.34845734 322.64758301]
[94.34845734 307.64758301]
[94.34845734 292.64758301]
[94.34845734 277.64758301]
[86.61116028 264.92031860]
[94.34845734 251.12014771]
[94.34845734 236.12014771]
[94.34845734 221.12014771]
[94.34845734 206.12014771]
[94.34845734 191.12014771]
[94.18253326 176.12106323]
[93.85070038 161.12474060]
[93.51886749 146.12840271]
[93.18704224 131.13208008]
[92.85520935 116.13574982]
[82.37044525 100.78057861]
[91.45708466 84.55885315]
[90.46224213 69.59188080]
[89.46739960 54.62490463]
[88.47255707 39.65793228]
[79.83702087 26.40130615]
[86.71317291 13.18889523]
[85.71833038 -1.77807760]
[84.72348785 -16.74505043]
[70.07277679 -34.70178223]
[80.15521240 -54.75645065]
[77.51418304 -69.52211761]
[74.87316132 -84.28778839]
[72.23213196 -99.05345917]
[69.59110260 -113.81912231]
[66.11557007 -117.92447662]
[64.75463104 -122.49921417]
[65.32375336 -126.63854218]
[67.29879761 -129.64941406]
[65.64289093 -144.55772400]
[63.98698044 -159.46604919]
[62.33106995 -174.37435913]
[60.67515945 -189.28268433]
[51.46169662 -202.14436340]
[57.74668884 -215.64799500]
[56.09077835 -230.55630493]
[42.54092407 -238.11811829]
[36.05414963 -252.21426392]
[39.12475967 -267.42449951]
[50.57203293 -277.90014648]
[65.99427032 -279.61315918]
[79.46129608 -271.90478516]
[85.79476929 -257.73910522]
[82.55934143 -242.56307983]
[70.99909973 -232.21221924]
[72.65500641 -217.30389404]
[81.75003052 -205.50857544]
[75.58348083 -190.93859863]
[77.23938751 -176.03027344]
[78.89530182 -161.12196350]
[80.55120850 -146.21363831]
[82.20711517 -131.30531311]
[84.35677338 -116.46015167]
[86.99779510 -101.69448090]
[89.63882446 -86.92881775]
[92.27985382 -72.16314697]
[94.92088318 -57.39747620]
[101.77111053 -54.85378265]
[107.33669281 -50.01362228]
[110.87141418 -43.46192551]
[111.87897491 -36.01683426]
[110.18217468 -28.62762642]
[105.95173645 -22.25367165]
[99.69046021 -17.73989487]
[100.68530273 -2.77292204]
[101.68015289 12.19405079]
[110.24452209 24.38014030]
[103.43952942 38.66308594]
[104.43437195 53.63006210]
[105.42921448 68.59703064]
[106.42405701 83.56401062]
[114.34980774 89.72900391]
[117.62955475 99.21942139]
[115.20140839 108.96256256]
[107.85153961 115.80391693]
[108.18336487 130.80024719]
[108.51519775 145.79656982]
[108.84703064 160.79290771]
[109.17886353 175.78923035]
[112.51897430 184.37805176]
[109.34845734 191.12014771]
[109.34845734 206.12014771]
[109.34845734 221.12014771]
[109.34845734 236.12014771]
[109.34845734 251.12014771]
[117.08576202 264.92031860]
[109.34845734 277.64758301]
[109.34845734 292.64758301]
[109.34845734 307.64758301]
[109.34845734 322.64758301]
[109.34845734 337.64758301]
[109.34845734 352.64758301]
[109.34845734 367.64758301]
[109.34845734 382.64758301]
[109.34845734 397.64758301]
[109.34845734 412.64758301]
[109.34845734 427.64758301]
[109.34845734 442.64758301]
[109.34845734 457.64758301]
[109.34845734 472.64758301]
[109.34845734 487.64758301]
[109.34845734 502.64758301]
[109.34845734 517.64758301]
[109.34845734 532.64758301]
[109.34845734 547.64758301]
[120.24301147 558.78070068]
[120.02933502 573.99285889]
[109.34845734 584.31054688]
[109.34845734 599.31054688]
[109.34845734 614.31054688]
[109.34845734 629.31054688]
[109.34845734 644.31054688]
[109.34845734 659.31054688]
] def
/pairs [
[1 141]
[2 140]
[3 139]
[4 138]
[5 137]
[6 136]
[9 133]
[10 132]
[11 131]
[12 130]
[13 129]
[14 128]
[15 127]
[16 126]
[17 125]
[18 124]
[19 123]
[20 122]
[21 121]
[22 120]
[23 119]
[24 118]
[25 117]
[26 116]
[27 115]
[29 113]
[30 112]
[31 111]
[32 110]
[33 109]
[34 107]
[35 106]
[36 105]
[37 104]
[38 103]
[40 99]
[41 98]
[42 97]
[43 96]
[45 94]
[46 93]
[47 92]
[49 85]
[50 84]
[51 83]
[52 82]
[53 81]
[57 80]
[58 79]
[59 78]
[60 77]
[61 76]
[63 74]
[64 73]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
