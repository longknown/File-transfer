%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Thu Jul 16 15:13:54 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GUGAUUUCUGACGUGGCAUCAUCAAGAUUCACACAUUACAUUGCAUGCAUGCAUAUGUCUAUGCAUCUUUGAGCUUGUUGUUCUGAUCUCAACAACCUAGCUAGCUAAUAUUUCUCUCCUGGCCCUGACCUGCAUGAUGCAUGGUUGCACGCAUGGAGAGAGAAGAAAGAGAUCGAAGCUAAUUAAACGCAUGUGUAUAUAUGUGUGGGAAUCUUGAUGAUGCUGCAUCGGAAAUUAA\
) def
/coor [
[96.10815430 796.83331299]
[102.15449524 780.99420166]
[102.15449524 765.99420166]
[102.15449524 750.99420166]
[102.15449524 735.99420166]
[102.15449524 720.99420166]
[102.15449524 705.99420166]
[102.15449524 690.99420166]
[102.15449524 675.99420166]
[102.15449524 660.99420166]
[102.15449524 645.99420166]
[94.41719818 633.26690674]
[102.15449524 619.46673584]
[102.15449524 604.46673584]
[102.15449524 589.46673584]
[102.15449524 574.46673584]
[102.15449524 559.46673584]
[102.15449524 544.46673584]
[102.15449524 529.46673584]
[102.15449524 514.46673584]
[102.15449524 499.46673584]
[102.15449524 484.46673584]
[102.15449524 469.46673584]
[102.15449524 454.46673584]
[102.15449524 439.46673584]
[102.15449524 424.46673584]
[102.15449524 409.46673584]
[102.15449524 394.46673584]
[102.15449524 379.46673584]
[102.15449524 364.46673584]
[101.95732880 349.46801758]
[101.56303406 334.47320557]
[101.16873932 319.47839355]
[100.77444458 304.48358154]
[100.38014221 289.48876953]
[99.98584747 274.49392700]
[86.33979797 268.47308350]
[76.62116241 257.07757568]
[72.79832458 242.53291321]
[75.68132782 227.71034241]
[84.75092316 215.56005859]
[98.25113678 208.52403259]
[97.85683441 193.52922058]
[97.46253967 178.53440857]
[97.06824493 163.53958130]
[96.67395020 148.54476929]
[96.27964783 133.54995728]
[95.88535309 118.55513763]
[84.83544922 108.41119385]
[69.86167908 109.29794312]
[54.88791656 110.18469238]
[39.91415024 111.07144928]
[24.94038391 111.95819855]
[9.96661758 112.84495544]
[-5.00714827 113.73170471]
[-18.39442825 123.20338440]
[-33.17560577 116.10065460]
[-34.14507294 99.73018646]
[-20.30552292 90.93251801]
[-5.89390039 98.75794220]
[9.07986546 97.87118530]
[24.05363083 96.98443604]
[39.02739716 96.09767914]
[54.00116348 95.21092987]
[68.97492981 94.32418060]
[83.94869232 93.43742371]
[85.41791534 86.08274078]
[70.70858765 83.14407349]
[73.64748383 68.43479156]
[88.35635376 71.37336731]
[89.82557678 64.01868439]
[76.34174347 57.44705582]
[62.85791397 50.87542725]
[49.37408447 44.30379868]
[33.79912567 48.15090179]
[21.16884613 38.25870132]
[21.17211533 22.21564865]
[33.80642700 12.32859993]
[49.37981415 16.18205261]
[55.94571304 30.81996727]
[69.42954254 37.39159775]
[82.91337585 43.96322632]
[96.39720154 50.53485489]
[110.04911804 44.31993866]
[113.94727325 29.83531189]
[117.84542847 15.35068607]
[121.74358368 0.86605966]
[125.64173889 -13.61856651]
[129.53988647 -28.10319328]
[133.43804932 -42.58781815]
[123.13573456 -49.08739090]
[114.89253998 -58.02859879]
[109.26844788 -68.78868103]
[106.64154053 -80.62185669]
[107.18254852 -92.71102905]
[110.84384155 -104.22415924]
[117.36337280 -114.37159729]
[126.28345490 -122.46017456]
[119.80058289 -135.98690796]
[113.31771851 -149.51364136]
[99.48720551 -158.32550049]
[100.47346497 -174.69496155]
[115.26191711 -181.78253174]
[128.63948059 -172.29711914]
[126.84445190 -155.99650574]
[133.32731628 -142.46977234]
[139.81018066 -128.94303894]
[146.28768921 -130.32577515]
[152.89683533 -130.76075745]
[159.49969482 -130.23893738]
[165.95846558 -128.77117920]
[172.61857605 -142.21153259]
[179.27867126 -155.65188599]
[185.93878174 -169.09223938]
[192.59889221 -182.53257751]
[199.25900269 -195.97293091]
[205.91909790 -209.41328430]
[212.57920837 -222.85362244]
[219.23931885 -236.29397583]
[214.42073059 -251.10678101]
[221.36648560 -264.64233398]
[235.51792908 -269.14483643]
[242.17803955 -282.58517456]
[234.12716675 -297.47094727]
[236.51861572 -314.05654907]
[248.21238708 -325.82559204]
[264.45339966 -328.27374268]
[270.93624878 -341.80047607]
[277.41912842 -355.32720947]
[283.90197754 -368.85394287]
[290.29580688 -382.42297363]
[296.60031128 -396.03375244]
[302.90481567 -409.64453125]
[309.20935059 -423.25531006]
[310.38015747 -440.16876221]
[326.95678711 -443.72579956]
[334.96365356 -428.78170776]
[322.82009888 -416.95080566]
[316.51559448 -403.34002686]
[310.21109009 -389.72924805]
[303.90658569 -376.11846924]
[303.94714355 -368.74227905]
[297.42871094 -362.37106323]
[290.94586182 -348.84432983]
[284.46298218 -335.31759644]
[277.98013306 -321.79086304]
[285.38705444 -310.69589233]
[286.35705566 -297.28253174]
[280.53057861 -285.04193115]
[269.33096313 -277.21286011]
[255.61837769 -275.92507935]
[248.95826721 -262.48471069]
[253.94746399 -248.49745178]
[247.38462830 -234.77215576]
[232.67967224 -229.63386536]
[226.01956177 -216.19352722]
[219.35945129 -202.75317383]
[212.69934082 -189.31282043]
[206.03924561 -175.87246704]
[199.37913513 -162.43212891]
[192.71902466 -148.99177551]
[186.05891418 -135.55142212]
[179.39881897 -122.11107635]
[192.69680786 -107.34812164]
[198.52256775 -88.30628967]
[195.74884033 -68.54293060]
[184.85862732 -51.76665878]
[167.86143494 -41.14138031]
[147.92266846 -38.68966293]
[144.02452087 -24.20503807]
[140.12635803 -9.72041225]
[136.22821045 4.76421404]
[132.33006287 19.24884033]
[128.43190002 33.73346710]
[124.53374481 48.21809387]
[138.66113281 43.17656326]
[153.65850830 42.89570618]
[167.96473694 47.40475464]
[180.09068298 56.23434830]
[188.77407837 68.46539307]
[193.11108398 82.82472229]
[192.65023804 97.81764221]
[187.43949890 111.88349152]
[178.02127075 123.55812836]
[165.37593079 131.62629700]
[150.81976318 135.24816895]
[135.86795044 134.04672241]
[122.07688141 128.14703369]
[110.88017273 118.16083527]
[111.27446747 133.15565491]
[111.66876221 148.15046692]
[112.06305695 163.14529419]
[112.45735931 178.14010620]
[112.85165405 193.13491821]
[113.24594879 208.12974548]
[127.09728241 214.44654846]
[136.79289246 226.10339355]
[140.45091248 240.75395203]
[137.39775085 255.47941589]
[128.29142761 267.36993408]
[114.98066711 274.09963989]
[115.37496185 289.09445190]
[115.76925659 304.08926392]
[116.16355133 319.08410645]
[116.55785370 334.07891846]
[116.95214844 349.07373047]
[120.06137085 354.87365723]
[119.82454681 360.52780151]
[117.15449524 364.46673584]
[117.15449524 379.46673584]
[117.15449524 394.46673584]
[117.15449524 409.46673584]
[117.15449524 424.46673584]
[117.15449524 439.46673584]
[117.15449524 454.46673584]
[117.15449524 469.46673584]
[117.15449524 484.46673584]
[117.15449524 499.46673584]
[117.15449524 514.46673584]
[117.15449524 529.46673584]
[117.15449524 544.46673584]
[117.15449524 559.46673584]
[117.15449524 574.46673584]
[117.15449524 589.46673584]
[117.15449524 604.46673584]
[117.15449524 619.46673584]
[124.89179993 633.26690674]
[117.15449524 645.99420166]
[117.15449524 660.99420166]
[117.15449524 675.99420166]
[117.15449524 690.99420166]
[117.15449524 705.99420166]
[117.15449524 720.99420166]
[117.15449524 735.99420166]
[117.15449524 750.99420166]
[117.15449524 765.99420166]
[117.15449524 780.99420166]
[123.20083618 796.83331299]
] def
/pairs [
[2 237]
[3 236]
[4 235]
[5 234]
[6 233]
[7 232]
[8 231]
[9 230]
[10 229]
[11 228]
[13 226]
[14 225]
[15 224]
[16 223]
[17 222]
[18 221]
[19 220]
[20 219]
[21 218]
[22 217]
[23 216]
[24 215]
[25 214]
[26 213]
[27 212]
[28 211]
[29 210]
[30 209]
[31 206]
[32 205]
[33 204]
[34 203]
[35 202]
[36 201]
[42 195]
[43 194]
[44 193]
[45 192]
[46 191]
[47 190]
[48 189]
[49 66]
[50 65]
[51 64]
[52 63]
[53 62]
[54 61]
[55 60]
[71 83]
[72 82]
[73 81]
[74 80]
[84 175]
[85 174]
[86 173]
[87 172]
[88 171]
[89 170]
[90 169]
[98 107]
[99 106]
[100 105]
[111 163]
[112 162]
[113 161]
[114 160]
[115 159]
[116 158]
[117 157]
[118 156]
[119 155]
[122 152]
[123 151]
[127 146]
[128 145]
[129 144]
[130 143]
[131 141]
[132 140]
[133 139]
[134 138]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
